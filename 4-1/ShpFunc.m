function N = ShpFunc(nelnd,ndime,xii)
 N = zeros(nelnd,1); %­«·s½sÂI
 if (ndime == 1)
    N(1) = 0.5*(1.+xii(1));
    N(2) = 0.5*(1.-xii(1));
 elseif (ndime == 2)
    if (nelnd == 3) %2D 3 1
        N(1) = xii(1);
        N(2) = xii(2);
        N(3) = 1-xii(1)-xii(2);
    end
    if (nelnd == 6) %2D 3 2
        N(1) = (2*xii(1)-1)*xii(1);
        N(2) = (2*xii(2)-1)*xii(2);
        N(3) = (2*(1-xii(1)-xii(2))-1)*(1-xii(1)-xii(2));
        N(4) = 4*xii(1)*xii(2);
        N(5) = 4*xii(2)*(1-xii(1)-xii(2));
        N(6) = 4*xii(1)*(1-xii(1)-xii(2));
    end
    if (nelnd == 4) % 2D 4 1
        N(1) = 0.25*(1-xii(1))*(1-xii(2));
        N(2) = 0.25*(1+xii(1))*(1-xii(2));
        N(3) = 0.25*(1+xii(1))*(1+xii(2));
        N(4) = 0.25*(1-xii(1))*(1+xii(2));
    end
    if (nelnd == 8) % 2D 4 2
        N(1) = -0.25*(1-xii(1))*(1-xii(2))*(1+xii(1)+xii(2));
        N(2) = 0.25*(1+xii(1))*(1-xii(2))*(xii(1)-xii(2)-1);
        N(3) = 0.25*(1+xii(1))*(1+xii(2))*(xii(1)+xii(2)-1);
        N(4) = 0.25*(1-xii(1))*(1+xii(2))*(xii(2)-xii(1)-1);
        N(5) = 0.5*(1-xii(1)*xii(1))*(1-xii(2));
        N(6) = 0.5*(1+xii(1))*(1-xii(2)*xii(2));
        N(7) = 0.5*(1-xii(1)*xii(1))*(1+xii(2));
        N(8) = 0.5*(1-xii(1))*(1-xii(2)*xii(2));
    end
 elseif (ndime == 3)
    if (nelnd == 4)% 3D 3 1
        N(1)=xii(1);
        N(2)=xii(2);
        N(3)=xii(3);
        N(4)=1-xii(1)-xii(2)-xii(3);
    end
    if (nelnd == 10) %3D 3 2
        xii(4)=(1-xii(1)-xii(2)-xii(3));
        N(1)=(2*xii(2)-1)*xii(1);
        N(2)=(2*xii(2)-1)*xii(2);
        N(3)=(2*xii(3)-1)*xii(3);
        N(4)=(2*xii(4)-1)*xii(4);
        N(5)=4*xii(1)*xii(2);
        N(6)=4*xii(2)*xii(3);
        N(7)=4*xii(3)*xii(1);
        N(8)=4*xii(4)*xii(1);
        N(9)=4*xii(2)*xii(4);
        N(10)=4*xii(3)*xii(4);
    end
    if (nelnd == 8)%3D 4 1
        N(1)=0.125*(1-xii(1))*(1-xii(2))*(1-xii(3));
        N(2)=0.125*(1+xii(1))*(1-xii(2))*(1-xii(3));
        N(3)=0.125*(1+xii(1))*(1+xii(2))*(1-xii(3));
        N(4)=0.125*(1-xii(1))*(1+xii(2))*(1-xii(3));
        N(5)=0.125*(1-xii(1))*(1-xii(2))*(1+xii(3));
        N(6)=0.125*(1+xii(1))*(1-xii(2))*(1+xii(3));
        N(7)=0.125*(1+xii(1))*(1+xii(2))*(1+xii(3));
        N(8)=0.125*(1-xii(1))*(1+xii(2))*(1+xii(3));
    end
    if (nelnd == 20)
        N(1)=0.125*(1-xii(1))*(1-xii(2))*(1-xii(3))*(-xii(1)-xii(2)-xii(3)-2);
        N(2)=0.125*(1+xii(1))*(1-xii(2))*(1-xii(3))*(xii(1)-xii(2)-xii(3)-2);
        N(3)=0.125*(1+xii(1))*(1+xii(2))*(1-xii(3))*(xii(1)+xii(2)-xii(3)-2);
        N(4)=0.125*(1-xii(1))*(1+xii(2))*(1-xii(3))*(-xii(1)+xii(2)-xii(3)-2);
        N(5)=0.125*(1-xii(1))*(1-xii(2))*(1+xii(3))*(-xii(1)-xii(2)+xii(3)-2);
        N(6)=0.125*(1+xii(1))*(1-xii(2))*(1+xii(3))*(xii(1)-xii(2)+xii(3)-2);
        N(7)=0.125*(1+xii(1))*(1+xii(2))*(1+xii(3))*(xii(1)+xii(2)+xii(3)-2);
        N(8)=0.125*(1-xii(1))*(1+xii(2))*(1+xii(3))*(-xii(1)+xii(2)+xii(3)-2);
        N(9)=0.25*(1-xii(1)*xii(1))*(1-xii(2))*(1-xii(3));
        N(10)=0.25*(1+xii(1))*(1-xii(2)*xii(2))*(1-xii(3));
        N(11)=0.25*(1-xii(1)*xii(1))*(1+xii(2))*(1-xii(3));
        N(12)=0.25*(1-xii(1))*(1-xii(2)*xii(2))*(1-xii(3));
        N(13)=0.25*(1-xii(1)*xii(1))*(1-xii(2))*(1+xii(3));
        N(14)=0.25*(1+xii(1))*(1-xii(2)*xii(2))*(1+xii(3));
        N(15)=0.25*(1-xii(1)*xii(1))*(1+xii(2))*(1+xii(3));
        N(16)=0.25*(1-xii(1))*(1-xii(2)*xii(2))*(1+xii(3));
        N(17)=0.25*(1-xii(1))*(1-xii(2))*(1-xii(3)*xii(3));
        N(18)=0.25*(1+xii(1))*(1-xii(2))*(1-xii(3)*xii(3));
        N(19)=0.25*(1+xii(1))*(1+xii(2))*(1-xii(3)*xii(3));
        N(20)=0.25*(1-xii(1))*(1+xii(2))*(1-xii(3)*xii(3));
    end
 end
end